@using ApexCharts
@using FinanceDashboard.Web.Models

<div class="card h-100" style="min-height: 350px;">
    <div class="card-header">
        <h5 class="mb-0">&#x1F967; Expenses by Category</h5>
    </div>
    <div class="card-body" style="min-height: 280px;">
        @if (CategoryData == null || !CategoryData.Any())
        {
            <div class="text-center py-4 text-muted">
                <p>No expenses this month.</p>
            </div>
        }
        else
        {
            <ApexChart TItem="CategoryData"
                       Title=""
                       Height="250">
                <ApexPointSeries TItem="CategoryData"
                                 Items="CategoryData"
                                 Name="Amount"
                                 SeriesType="SeriesType.Donut"
                                 XValue="@(e => $"{e.Icon} {e.CategoryName}")"
                                 YValue="@(e => e.Amount)"
                                 ShowDataLabels />
            </ApexChart>
            
            <div class="mt-3">
                @foreach (var category in CategoryData.Take(5))
                {
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <span>@category.Icon @category.CategoryName</span>
                        <span class="badge bg-secondary">$@category.Amount.ToString("N2") (@category.Percentage%)</span>
                    </div>
                }
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public List<CategoryData>? CategoryData { get; set; }
}
